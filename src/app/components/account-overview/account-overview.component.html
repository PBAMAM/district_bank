<app-client-layout>
  <div class="account-overview">
  <div class="welcome-section">
    <h1>Hello {{ currentUser?.firstName }} {{ currentUser?.lastName }}</h1>
    
    <div class="notifications">
      <div class="notification-item">
        <span class="notification-text">Open orders</span>
        <span class="notification-arrow">‚ñº</span>
      </div>
      <div class="notification-item">
        <span class="notification-text">1 more note</span>
        <span class="notification-arrow">‚ñº</span>
      </div>
    </div>
  </div>

  <div class="balance-forecast" *ngIf="!isLoading && forecastData.currentBalance > 0">
    <h2>Your account balance forecast</h2>
    <p>{{ (checkingAccounts[0] && checkingAccounts[0].accountType) || 'Main Account' }}</p>
    
    <div class="forecast-chart">
      <div class="chart-container">
        <div class="chart-area">
          <div class="chart-line"></div>
          <div class="chart-points">
            <div class="chart-point today">
              <span class="point-label">heute</span>
              <span class="point-value">{{ formatCurrency(forecastData.currentBalance, 'EUR') }}</span>
            </div>
            <div class="chart-point future">
              <span class="point-label">{{ forecastData.futureDate }}</span>
              <span class="point-value">{{ formatCurrency(forecastData.futureBalance, 'EUR') }}</span>
            </div>
          </div>
        </div>
      </div>
      <p class="chart-description">Expected change in account balance by month-end.</p>
      <a href="#" class="chart-link">Check expected sales.</a>
    </div>
  </div>

  <div class="accounts-section">
    <div class="section-header">
      <h2>Accounts and cards</h2>
      <span class="expand-icon">‚ñº</span>
    </div>
    
    <div class="accounts-list" *ngIf="!isLoading; else loadingTemplate">
      <div class="account-item" *ngFor="let account of checkingAccounts">
        <div class="account-icon">
          <span class="icon">{{ getAccountIcon(account.accountType) }}</span>
        </div>
        
        <div class="account-details">
          <div class="account-type">{{ account.accountType }}</div>
          <div class="account-iban">{{ account.iban }} ‚Ä¢ {{ account.ownerName }}</div>
        </div>
        
        <div class="account-balance">
          <div class="balance-amount" [class]="getBalanceClass(account.balance)">
            {{ formatCurrency(account.balance, account.currency) }}
          </div>
          <div class="balance-info" *ngIf="account.currency === 'USD'">
            {{ formatCurrency(account.balance * 0.85, 'EUR') }}
          </div>
        </div>
        
        <div class="account-actions">
          <span class="info-icon">‚ÑπÔ∏è</span>
        </div>
      </div>
      
      <div class="accounts-subtotal" *ngIf="checkingAccounts.length > 0">
        <span class="subtotal-label">Subtotal:</span>
        <span class="subtotal-amount" [class]="checkingTotal >= 0 ? 'text-success' : 'text-danger'">
          {{ formatCurrency(checkingTotal, 'EUR') }}
        </span>
      </div>
    </div>
    
    <ng-template #loadingTemplate>
      <div class="loading">
        <div class="spinner"></div>
        <p>Loading accounts...</p>
      </div>
    </ng-template>
  </div>

  <div class="money-investment-section" *ngIf="savingsAccounts.length > 0 || investmentAccounts.length > 0">
    <div class="section-header">
      <h2>Money investment</h2>
      <span class="expand-icon">‚ñº</span>
    </div>
    
    <div class="investment-list">
      <!-- Savings Accounts -->
      <div class="investment-item" *ngFor="let account of savingsAccounts">
        <div class="investment-icon">
          <span class="icon">{{ getAccountIcon(account.accountType) }}</span>
        </div>
        <div class="investment-details">
          <div class="investment-type">{{ account.accountType }}</div>
          <div class="investment-iban">{{ account.iban }} ‚Ä¢ {{ account.ownerName }}</div>
        </div>
        <div class="investment-balance" [class]="getBalanceClass(account.balance)">
          {{ formatCurrency(account.balance, account.currency) }}
        </div>
        <div class="investment-actions">
          <span class="info-icon">‚ÑπÔ∏è</span>
        </div>
      </div>
      
      <!-- Investment Accounts -->
      <div class="investment-item" *ngFor="let account of investmentAccounts">
        <div class="investment-icon">
          <span class="icon">{{ getAccountIcon(account.accountType) }}</span>
        </div>
        <div class="investment-details">
          <div class="investment-type">{{ account.accountType }}</div>
          <div class="investment-iban">{{ account.iban }} ‚Ä¢ {{ account.ownerName }}</div>
        </div>
        <div class="investment-balance" [class]="getBalanceClass(account.balance)">
          {{ formatCurrency(account.balance, account.currency) }}
        </div>
        <div class="investment-actions">
          <span class="info-icon">‚ÑπÔ∏è</span>
        </div>
      </div>
      
      <div class="investment-subtotal" *ngIf="savingsTotal + investmentTotal !== 0">
        <span class="subtotal-label">Subtotal:</span>
        <span class="subtotal-amount" [class]="(savingsTotal + investmentTotal) >= 0 ? 'text-success' : 'text-danger'">
          {{ formatCurrency(savingsTotal + investmentTotal, 'EUR') }}
        </span>
      </div>
    </div>
  </div>

  <div class="securities-section" *ngIf="securitiesAccounts.length > 0">
    <div class="section-header">
      <h2>Securities account</h2>
      <span class="expand-icon">‚ñº</span>
    </div>
    
    <div class="securities-list">
      <div class="securities-item" *ngFor="let account of securitiesAccounts">
        <div class="securities-icon">
          <span class="icon">{{ getAccountIcon(account.accountType) }}</span>
        </div>
        <div class="securities-details">
          <div class="securities-type">{{ account.accountType }}</div>
          <div class="securities-iban">{{ account.iban }} ‚Ä¢ {{ account.ownerName }}</div>
        </div>
        <div class="securities-balance" [class]="getBalanceClass(account.balance)">
          {{ formatCurrency(account.balance, account.currency) }}
        </div>
        <div class="securities-actions">
          <span class="info-icon">‚ÑπÔ∏è</span>
        </div>
      </div>
      
      <div class="securities-subtotal" *ngIf="securitiesTotal !== 0">
        <span class="subtotal-label">Subtotal:</span>
        <span class="subtotal-amount" [class]="securitiesTotal >= 0 ? 'text-success' : 'text-danger'">
          {{ formatCurrency(securitiesTotal, 'EUR') }}
        </span>
      </div>
    </div>
  </div>

  <div class="loans-section" *ngIf="loanAccounts.length > 0">
    <div class="section-header">
      <h2>Loans & financing</h2>
      <span class="expand-icon">‚ñº</span>
    </div>
    
    <div class="loans-list">
      <div class="loans-item" *ngFor="let account of loanAccounts">
        <div class="loans-icon">
          <span class="icon">{{ getAccountIcon(account.accountType) }}</span>
        </div>
        <div class="loans-details">
          <div class="loans-type">{{ account.accountType }}</div>
          <div class="loans-iban">{{ account.iban }} ‚Ä¢ {{ account.ownerName }}</div>
        </div>
        <div class="loans-balance" [class]="getBalanceClass(account.balance)">
          {{ formatCurrency(account.balance, account.currency) }}
        </div>
        <div class="loans-actions">
          <span class="info-icon">‚ÑπÔ∏è</span>
        </div>
      </div>
      
      <div class="loans-subtotal" *ngIf="loanTotal !== 0">
        <span class="subtotal-label">Subtotal:</span>
        <span class="subtotal-amount" [class]="loanTotal >= 0 ? 'text-success' : 'text-danger'">
          {{ formatCurrency(loanTotal, 'EUR') }}
        </span>
      </div>
    </div>
  </div>

  <div class="assets-section" *ngIf="assetAccounts.length > 0">
    <div class="section-header">
      <h2>Assets</h2>
      <span class="expand-icon">‚ñº</span>
    </div>
    
    <div class="assets-list">
      <div class="assets-item" *ngFor="let account of assetAccounts">
        <div class="assets-icon">{{ getAssetIcon(account.accountType) }}</div>
        <div class="assets-details">
          <div class="assets-type">{{ account.accountType }}</div>
          <div class="assets-description">{{ account.accountName }} ‚Ä¢ {{ account.ownerName }}</div>
        </div>
        <div class="assets-value" [class]="getBalanceClass(account.balance)">
          {{ formatCurrency(account.balance, account.currency) }}
        </div>
        <div class="assets-actions">
          <span class="info-icon">‚ÑπÔ∏è</span>
        </div>
      </div>
      
      <div class="assets-subtotal" *ngIf="assetTotal !== 0">
        <span class="subtotal-label">Subtotal:</span>
        <span class="subtotal-amount" [class]="assetTotal >= 0 ? 'text-success' : 'text-danger'">
          {{ formatCurrency(assetTotal, 'EUR') }}
        </span>
      </div>
    </div>
  </div>

  <div class="total-amount" *ngIf="!isLoading && grandTotal !== 0">
    <div class="total-label">Total amount:</div>
    <div class="total-value" [class]="grandTotal >= 0 ? 'text-success' : 'text-danger'">
      {{ formatCurrency(grandTotal, 'EUR') }}
    </div>
  </div>

  <div class="footer-actions">
    <div class="action-links">
      <a href="#" class="action-link">
        <span class="action-icon">‚ÜïÔ∏è</span>
        Change sort order
      </a>
      <a href="#" class="action-link">
        <span class="action-icon">üñ®Ô∏è</span>
        Print view
      </a>
      <a href="#" class="action-link">
        <span class="action-icon">üëÅÔ∏è</span>
        Current account detail overview
      </a>
    </div>
    
    <div class="multibanking-section">
      <div class="multibanking-content">
        <span class="multibanking-icon">+</span>
        <div class="multibanking-text">
          <p>A single point of access to all of your financial information - add your assets, accounts and securities accounts with other banks or payment services.</p>
        </div>
      </div>
    </div>
    
    <div class="features-section">
      <div class="features-progress">
        <span class="progress-text">3/3 Active</span>
        <div class="progress-circle"></div>
      </div>
      <div class="features-text">
        <p>It's great that you have already activated all of the features. You can now customise them to suit your specific needs.</p>
        <button class="customise-btn">Customise features</button>
      </div>
    </div>
  </div>
  </div>
</app-client-layout>
